<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>CREATE SEQUENCE</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 7.4beta4 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="SQL Commands"
HREF="sql-commands.html"><LINK
REL="PREVIOUS"
TITLE="CREATE SCHEMA"
HREF="sql-createschema.html"><LINK
REL="NEXT"
TITLE="CREATE TABLE"
HREF="sql-createtable.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
NAME="creation"
CONTENT="2003-10-03T03:19:47"></HEAD
><BODY
CLASS="REFENTRY"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="5"
ALIGN="center"
VALIGN="bottom"
>PostgreSQL 7.4beta4 Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-createschema.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-createschema.html"
>Fast Backward</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
HREF="sql-createtable.html"
>Fast Forward</A
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
HREF="sql-createtable.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="SQL-CREATESEQUENCE"
></A
>CREATE SEQUENCE</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN38073"
></A
><H2
>Name</H2
>CREATE SEQUENCE&nbsp;--&nbsp;define a new sequence generator</DIV
><A
NAME="AEN38076"
></A
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN38078"
></A
><H2
>Synopsis</H2
><PRE
CLASS="SYNOPSIS"
>CREATE [ TEMPORARY | TEMP ] SEQUENCE <VAR
CLASS="REPLACEABLE"
>name</VAR
> [ INCREMENT [ BY ] <VAR
CLASS="REPLACEABLE"
>increment</VAR
> ]
    [ MINVALUE <VAR
CLASS="REPLACEABLE"
>minvalue</VAR
> | NO MINVALUE ] [ MAXVALUE <VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
> | NO MAXVALUE ]
    [ START [ WITH ] <VAR
CLASS="REPLACEABLE"
>start</VAR
> ] [ CACHE <VAR
CLASS="REPLACEABLE"
>cache</VAR
> ] [ [ NO ] CYCLE ]</PRE
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN38086"
></A
><H2
>Description</H2
><P
>   <TT
CLASS="COMMAND"
>CREATE SEQUENCE</TT
> creates a new sequence number
   generator.  This involves creating and initializing a new special
   single-row table with the name <VAR
CLASS="REPLACEABLE"
>name</VAR
>.  The generator will be
   owned by the user issuing the command.
  </P
><P
>   If a schema name is given then the sequence is created in the
   specified schema.  Otherwise it is created in the current schema.
   Temporary sequences exist in a special schema, so a schema name may not be
   given when creating a temporary sequence.
   The sequence name must be distinct from the name of any other sequence,
   table, index, or view in the same schema.
  </P
><P
>   After a sequence is created, you use the functions
   <CODE
CLASS="FUNCTION"
>nextval</CODE
>,
   <CODE
CLASS="FUNCTION"
>currval</CODE
>, and
   <CODE
CLASS="FUNCTION"
>setval</CODE
>
   to operate on the sequence.  These functions are documented in
   <A
HREF="functions-sequence.html"
>Section 9.11</A
>.
  </P
><P
>   Although you cannot update a sequence directly, you can use a query like

</P><PRE
CLASS="PROGRAMLISTING"
>SELECT * FROM <VAR
CLASS="REPLACEABLE"
>name</VAR
>;</PRE
><P>

   to examine the parameters and current state of a sequence.  In particular,
   the <VAR
CLASS="LITERAL"
>last_value</VAR
> field of the sequence shows the last value
   allocated by any session.  (Of course, this value may be obsolete
   by the time it's printed, if other sessions are actively doing
   <CODE
CLASS="FUNCTION"
>nextval</CODE
> calls.)
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN38102"
></A
><H2
>Parameters</H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><VAR
CLASS="LITERAL"
>TEMPORARY</VAR
> or <VAR
CLASS="LITERAL"
>TEMP</VAR
></DT
><DD
><P
>      If specified, the sequence object is created only for this
      session, and is automatically dropped on session exit.  Existing
      permanent sequences with the same name are not visible (in this
      session) while the temporary sequence exists, unless they are
      referenced with schema-qualified names.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>name</VAR
></DT
><DD
><P
>      The name (optionally schema-qualified) of the sequence to be created.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>increment</VAR
></DT
><DD
><P
>      The optional clause <VAR
CLASS="LITERAL"
>INCREMENT BY <VAR
CLASS="REPLACEABLE"
>increment</VAR
></VAR
> specified,
      which value is added to the current sequence value to create a
      new value.  A positive value will make an ascending sequence, a
      negative one a descending sequence.  The default value is 1.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>minvalue</VAR
><BR><VAR
CLASS="LITERAL"
>NO MINVALUE</VAR
></DT
><DD
><P
>      The optional clause <VAR
CLASS="LITERAL"
>MINVALUE <VAR
CLASS="REPLACEABLE"
>minvalue</VAR
></VAR
> determines
      the minimum value a sequence can generate. If this clause is not
      supplied or <VAR
CLASS="OPTION"
>NO MINVALUE</VAR
> is specified, then
      defaults will be used.  The defaults are 1 and
      -2<SUP
>63</SUP
>-1 for ascending and descending sequences,
      respectively.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
><BR><VAR
CLASS="LITERAL"
>NO MAXVALUE</VAR
></DT
><DD
><P
>      The optional clause <VAR
CLASS="LITERAL"
>MAXVALUE <VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
></VAR
> determines
      the maximum value for the sequence. If this clause is not
      supplied or <VAR
CLASS="OPTION"
>NO MAXVALUE</VAR
> is specified, then
      default values will be used.  The defaults are
      2<SUP
>63</SUP
>-1 and -1 for ascending and descending
      sequences, respectively.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>start</VAR
></DT
><DD
><P
>      The optional clause <VAR
CLASS="LITERAL"
>START WITH <VAR
CLASS="REPLACEABLE"
>start</VAR
> </VAR
> allows the
      sequence to begin anywhere.  The default starting value is
      <VAR
CLASS="REPLACEABLE"
>minvalue</VAR
> for
      ascending sequences and <VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
> for descending ones.
     </P
></DD
><DT
><VAR
CLASS="REPLACEABLE"
>cache</VAR
></DT
><DD
><P
>      The optional clause <VAR
CLASS="LITERAL"
>CACHE <VAR
CLASS="REPLACEABLE"
>cache</VAR
></VAR
> specifies how
      many sequence numbers are to be preallocated and stored in
      memory for faster access. The minimum value is 1 (only one value
      can be generated at a time, i.e., no cache), and this is also the
      default.
     </P
></DD
><DT
><VAR
CLASS="LITERAL"
>CYCLE</VAR
><BR><VAR
CLASS="LITERAL"
>NO CYCLE</VAR
></DT
><DD
><P
>      The <VAR
CLASS="LITERAL"
>CYCLE</VAR
> option allows the sequence to wrap
      around when the <VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
> or <VAR
CLASS="REPLACEABLE"
>minvalue</VAR
> has been reached by an
      ascending or descending sequence respectively. If the limit is
      reached, the next number generated will be the <VAR
CLASS="REPLACEABLE"
>minvalue</VAR
> or <VAR
CLASS="REPLACEABLE"
>maxvalue</VAR
>, respectively.
     </P
><P
>      If <VAR
CLASS="LITERAL"
>NO CYCLE</VAR
> is specified, any calls to
      <CODE
CLASS="FUNCTION"
>nextval</CODE
> after the sequence has reached its
      maximum value will return an error.  If neither
      <VAR
CLASS="LITERAL"
>CYCLE</VAR
> or <VAR
CLASS="LITERAL"
>NO CYCLE</VAR
> are
      specified, <VAR
CLASS="LITERAL"
>NO CYCLE</VAR
> is the default.
     </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN38179"
></A
><H2
>Notes</H2
><P
>   Use <TT
CLASS="COMMAND"
>DROP SEQUENCE</TT
> to remove a sequence.
  </P
><P
>   Sequences are based on <TT
CLASS="TYPE"
>bigint</TT
> arithmetic, so the range
   cannot exceed the range of an eight-byte integer
   (-9223372036854775808 to 9223372036854775807).  On some older
   platforms, there may be no compiler support for eight-byte
   integers, in which case sequences use regular <TT
CLASS="TYPE"
>integer</TT
>
   arithmetic (range -2147483648 to +2147483647).
  </P
><P
>   Unexpected results may be obtained if a <VAR
CLASS="REPLACEABLE"
>cache</VAR
> setting greater than one is
   used for a sequence object that will be used concurrently by
   multiple sessions.  Each session will allocate and cache successive
   sequence values during one access to the sequence object and
   increase the sequence object's <VAR
CLASS="LITERAL"
>last_value</VAR
> accordingly.
   Then, the next <VAR
CLASS="REPLACEABLE"
>cache</VAR
>-1
   uses of <CODE
CLASS="FUNCTION"
>nextval</CODE
> within that session simply return the
   preallocated values without touching the sequence object.  So, any
   numbers allocated but not used within a session will be lost when
   that session ends, resulting in <SPAN
CLASS="QUOTE"
>"holes"</SPAN
> in the
   sequence.
  </P
><P
>   Furthermore, although multiple sessions are guaranteed to allocate
   distinct sequence values, the values may be generated out of
   sequence when all the sessions are considered.  For example, with
   a <VAR
CLASS="REPLACEABLE"
>cache</VAR
> setting of 10,
   session A might reserve values 1..10 and return
   <CODE
CLASS="FUNCTION"
>nextval</CODE
>=1, then session B might reserve values
   11..20 and return <CODE
CLASS="FUNCTION"
>nextval</CODE
>=11 before session A
   has generated <VAR
CLASS="LITERAL"
>nextval</VAR
>=2.  Thus, with a
   <VAR
CLASS="REPLACEABLE"
>cache</VAR
> setting of one
   it is safe to assume that <CODE
CLASS="FUNCTION"
>nextval</CODE
> values are generated
   sequentially; with a <VAR
CLASS="REPLACEABLE"
>cache</VAR
> setting greater than one you
   should only assume that the <CODE
CLASS="FUNCTION"
>nextval</CODE
> values are all
   distinct, not that they are generated purely sequentially.  Also,
   <VAR
CLASS="LITERAL"
>last_value</VAR
> will reflect the latest value reserved by
   any session, whether or not it has yet been returned by
   <CODE
CLASS="FUNCTION"
>nextval</CODE
>.
  </P
><P
>   Another consideration is that a <CODE
CLASS="FUNCTION"
>setval</CODE
> executed on
   such a sequence will not be noticed by other sessions until they
   have used up any preallocated values they have cached.
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN38205"
></A
><H2
>Examples</H2
><P
>   Create an ascending sequence called <VAR
CLASS="LITERAL"
>serial</VAR
>, starting at 101:
</P><PRE
CLASS="PROGRAMLISTING"
>CREATE SEQUENCE serial START 101;</PRE
><P>
  </P
><P
>   Select the next number from this sequence:
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT nextval('serial');
    
 nextval
---------
     114</PRE
><P>
  </P
><P
>   Use this sequence in an <TT
CLASS="COMMAND"
>INSERT</TT
> command:
</P><PRE
CLASS="PROGRAMLISTING"
>INSERT INTO distributors VALUES (nextval('serial'), 'nothing');</PRE
><P>
  </P
><P
>   Update the sequence value after a <TT
CLASS="COMMAND"
>COPY FROM</TT
>:
</P><PRE
CLASS="PROGRAMLISTING"
>BEGIN;
COPY distributors FROM 'input_file';
SELECT setval('serial', max(id)) FROM distributors;
END;</PRE
><P>
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN38218"
></A
><H2
>Compatibility</H2
><P
>   <TT
CLASS="COMMAND"
>CREATE SEQUENCE</TT
> is a
   <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> language extension.  There is
   no <TT
CLASS="COMMAND"
>CREATE SEQUENCE</TT
> statement in the SQL
   standard.
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-createschema.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="sql-createtable.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>CREATE SCHEMA</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="sql-commands.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>CREATE TABLE</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>