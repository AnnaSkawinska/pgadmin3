<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>9.9. Date/Time Functions and Operators</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css">
<link rev="made" href="pgsql-docs@postgresql.org">
<meta name="generator" content="DocBook XSL Stylesheets V1.64.1">
<link rel="home" href="index.html" title="PostgreSQL 8.1devel Documentation">
<link rel="up" href="functions.html" title="Chapter 9. Functions and Operators">
<link rel="previous" href="functions-formatting.html" title="9.8. Data Type Formatting Functions">
<link rel="next" href="functions-geometry.html" title="9.10. Geometric Functions and Operators">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="en">
<div class="titlepage">
<div><div><h2 class="title" style="clear: both">
<a name="functions-datetime"></a>9.9. Date/Time Functions and Operators</h2></div></div>
<div></div>
</div>
<p>   <a href="functions-datetime.html#functions-datetime-table" title="Table 9.26. Date/Time Functions">Table 9.26, &#8220;Date/Time Functions&#8221;</a> shows the available
   functions for date/time value processing, with details appearing in
   the following subsections.  <a href="functions-datetime.html#operators-datetime-table" title="Table 9.25. Date/Time Operators">Table 9.25, &#8220;Date/Time Operators&#8221;</a> illustrates the behaviors of
   the basic arithmetic operators (<tt class="literal">+</tt>,
   <tt class="literal">*</tt>, etc.).  For formatting functions, refer to
   <a href="functions-formatting.html" title="9.8. Data Type Formatting Functions">Section 9.8, &#8220;Data Type Formatting Functions&#8221;</a>.  You should be familiar with
   the background information on date/time data types from <a href="datatype-datetime.html" title="8.5. Date/Time Types">Section 8.5, &#8220;Date/Time Types&#8221;</a>.
  </p>
<p>   All the functions and operators described below that take <tt class="type">time</tt> or <tt class="type">timestamp</tt>
   inputs actually come in two variants: one that takes <tt class="type">time with time zone</tt> or <tt class="type">timestamp
   with time zone</tt>, and one that takes <tt class="type">time without time zone</tt> or <tt class="type">timestamp without time zone</tt>.
   For brevity, these variants are not shown separately.  Also, the
   <tt class="literal">+</tt> and <tt class="literal">*</tt> operators come in commutative pairs (for
   example both date + integer and integer + date); we show only one of each
   such pair.
  </p>
<div class="table">
<a name="operators-datetime-table"></a><p class="title"><b>Table 9.25. Date/Time Operators</b></p>
<table summary="Date/Time Operators" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Operator</th>
<th>Example</th>
<th>Result</th>
</tr></thead>
<tbody>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">date '2001-09-28' + integer '7'</tt></td>
<td><tt class="literal">date '2001-10-05'</tt></td>
</tr>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">date '2001-09-28' + interval '1 hour'</tt></td>
<td><tt class="literal">timestamp '2001-09-28 01:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">date '2001-09-28' + time '03:00'</tt></td>
<td><tt class="literal">timestamp '2001-09-28 03:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">interval '1 day' + interval '1 hour'</tt></td>
<td><tt class="literal">interval '1 day 01:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">timestamp '2001-09-28 01:00' + interval '23 hours'</tt></td>
<td><tt class="literal">timestamp '2001-09-29 00:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">+</tt></td>
<td><tt class="literal">time '01:00' + interval '3 hours'</tt></td>
<td><tt class="literal">time '04:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">- interval '23 hours'</tt></td>
<td><tt class="literal">interval '-23:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">date '2001-10-01' - date '2001-09-28'</tt></td>
<td><tt class="literal">integer '3'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">date '2001-10-01' - integer '7'</tt></td>
<td><tt class="literal">date '2001-09-24'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">date '2001-09-28' - interval '1 hour'</tt></td>
<td><tt class="literal">timestamp '2001-09-27 23:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">time '05:00' - time '03:00'</tt></td>
<td><tt class="literal">interval '02:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">time '05:00' - interval '2 hours'</tt></td>
<td><tt class="literal">time '03:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">timestamp '2001-09-28 23:00' - interval '23 hours'</tt></td>
<td><tt class="literal">timestamp '2001-09-28 00:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">interval '1 day' - interval '1 hour'</tt></td>
<td><tt class="literal">interval '23:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">-</tt></td>
<td><tt class="literal">timestamp '2001-09-29 03:00' - timestamp '2001-09-27 12:00'</tt></td>
<td><tt class="literal">interval '1 day 15:00'</tt></td>
</tr>
<tr>
<td><tt class="literal">*</tt></td>
<td><tt class="literal">interval '1 hour' * double precision '3.5'</tt></td>
<td><tt class="literal">interval '03:30'</tt></td>
</tr>
<tr>
<td><tt class="literal">/</tt></td>
<td><tt class="literal">interval '1 hour' / double precision '1.5'</tt></td>
<td><tt class="literal">interval '00:40'</tt></td>
</tr>
</tbody>
</table>
</div>
<div class="table">
<a name="functions-datetime-table"></a><p class="title"><b>Table 9.26. Date/Time Functions</b></p>
<table summary="Date/Time Functions" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Function</th>
<th>Return Type</th>
<th>Description</th>
<th>Example</th>
<th>Result</th>
</tr></thead>
<tbody>
<tr>
<td><tt class="literal"><tt class="function">age</tt>(<tt class="type">timestamp</tt>, <tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">interval</tt></td>
<td>Subtract arguments, producing a &#8220;<span class="quote">symbolic</span>&#8221; result that
        uses years and months</td>
<td><tt class="literal">age(timestamp '2001-04-10', timestamp '1957-06-13')</tt></td>
<td><tt class="literal">43 years 9 mons 27 days</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">age</tt>(<tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">interval</tt></td>
<td>Subtract from <tt class="function">current_date</tt>
</td>
<td><tt class="literal">age(timestamp '1957-06-13')</tt></td>
<td><tt class="literal">43 years 8 mons 3 days</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">current_date</tt></tt></td>
<td><tt class="type">date</tt></td>
<td>Today's date; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">current_time</tt></tt></td>
<td><tt class="type">time with time zone</tt></td>
<td>Time of day; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">current_timestamp</tt></tt></td>
<td><tt class="type">timestamp with time zone</tt></td>
<td>Date and time; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">date_part</tt>(<tt class="type">text</tt>, <tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">double precision</tt></td>
<td>Get subfield (equivalent to
         <tt class="function">extract</tt>); see <a href="functions-datetime.html#functions-datetime-extract" title="9.9.1. EXTRACT, date_part">Section 9.9.1, &#8220;EXTRACT, date_part&#8221;</a>
</td>
<td><tt class="literal">date_part('hour', timestamp '2001-02-16 20:38:40')</tt></td>
<td><tt class="literal">20</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">date_part</tt>(<tt class="type">text</tt>, <tt class="type">interval</tt>)</tt></td>
<td><tt class="type">double precision</tt></td>
<td>Get subfield (equivalent to
         <tt class="function">extract</tt>); see <a href="functions-datetime.html#functions-datetime-extract" title="9.9.1. EXTRACT, date_part">Section 9.9.1, &#8220;EXTRACT, date_part&#8221;</a>
</td>
<td><tt class="literal">date_part('month', interval '2 years 3 months')</tt></td>
<td><tt class="literal">3</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">date_trunc</tt>(<tt class="type">text</tt>, <tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">timestamp</tt></td>
<td>Truncate to specified precision; see also <a href="functions-datetime.html#functions-datetime-trunc" title="9.9.2. date_trunc">Section 9.9.2, &#8220;date_trunc&#8221;</a>
</td>
<td><tt class="literal">date_trunc('hour', timestamp '2001-02-16 20:38:40')</tt></td>
<td><tt class="literal">2001-02-16 20:00:00</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">extract</tt>(<i class="parameter"><tt>field</tt></i> from
         <tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">double precision</tt></td>
<td>Get subfield; see <a href="functions-datetime.html#functions-datetime-extract" title="9.9.1. EXTRACT, date_part">Section 9.9.1, &#8220;EXTRACT, date_part&#8221;</a>
</td>
<td><tt class="literal">extract(hour from timestamp '2001-02-16 20:38:40')</tt></td>
<td><tt class="literal">20</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">extract</tt>(<i class="parameter"><tt>field</tt></i> from
         <tt class="type">interval</tt>)</tt></td>
<td><tt class="type">double precision</tt></td>
<td>Get subfield; see <a href="functions-datetime.html#functions-datetime-extract" title="9.9.1. EXTRACT, date_part">Section 9.9.1, &#8220;EXTRACT, date_part&#8221;</a>
</td>
<td><tt class="literal">extract(month from interval '2 years 3 months')</tt></td>
<td><tt class="literal">3</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">isfinite</tt>(<tt class="type">timestamp</tt>)</tt></td>
<td><tt class="type">boolean</tt></td>
<td>Test for finite time stamp (not equal to infinity)</td>
<td><tt class="literal">isfinite(timestamp '2001-02-16 21:28:30')</tt></td>
<td><tt class="literal">true</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">isfinite</tt>(<tt class="type">interval</tt>)</tt></td>
<td><tt class="type">boolean</tt></td>
<td>Test for finite interval</td>
<td><tt class="literal">isfinite(interval '4 hours')</tt></td>
<td><tt class="literal">true</tt></td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">localtime</tt></tt></td>
<td><tt class="type">time</tt></td>
<td>Time of day; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">localtimestamp</tt></tt></td>
<td><tt class="type">timestamp</tt></td>
<td>Date and time; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">now</tt>()</tt></td>
<td><tt class="type">timestamp with time zone</tt></td>
<td>Current date and time (equivalent to
         <tt class="function">current_timestamp</tt>); see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td><tt class="literal"><tt class="function">timeofday()</tt></tt></td>
<td><tt class="type">text</tt></td>
<td>Current date and time; see <a href="functions-datetime.html#functions-datetime-current" title="9.9.4. Current Date/Time">Section 9.9.4, &#8220;Current Date/Time&#8221;</a>
</td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
</div>
<p>    In addition to these functions, the SQL <tt class="literal">OVERLAPS</tt> operator is
    supported:
</p>
<pre class="synopsis">( <i class="replaceable"><tt>start1</tt></i>, <i class="replaceable"><tt>end1</tt></i> ) OVERLAPS ( <i class="replaceable"><tt>start2</tt></i>, <i class="replaceable"><tt>end2</tt></i> )
( <i class="replaceable"><tt>start1</tt></i>, <i class="replaceable"><tt>length1</tt></i> ) OVERLAPS ( <i class="replaceable"><tt>start2</tt></i>, <i class="replaceable"><tt>length2</tt></i> )</pre>
<p>
    This expression yields true when two time periods (defined by their
    endpoints) overlap, false when they do not overlap.  The endpoints
    can be specified as pairs of dates, times, or time stamps; or as
    a date, time, or time stamp followed by an interval.
   </p>
<pre class="screen">SELECT (DATE '2001-02-16', DATE '2001-12-21') OVERLAPS
       (DATE '2001-10-30', DATE '2002-10-30');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">true</tt>
SELECT (DATE '2001-02-16', INTERVAL '100 days') OVERLAPS
       (DATE '2001-10-30', DATE '2002-10-30');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">false</tt></pre>
<div class="sect2" lang="en">
<div class="titlepage">
<div><div><h3 class="title">
<a name="functions-datetime-extract"></a>9.9.1. <tt class="function">EXTRACT</tt>, <tt class="function">date_part</tt></h3></div></div>
<div></div>
</div>
<pre class="synopsis">EXTRACT (<i class="replaceable"><tt>field</tt></i> FROM <i class="replaceable"><tt>source</tt></i>)</pre>
<p>    The <tt class="function">extract</tt> function retrieves subfields
    such as year or hour from date/time values.
    <i class="replaceable"><tt>source</tt></i> must be a value expression of
    type <tt class="type">timestamp</tt>, <tt class="type">time</tt>, or <tt class="type">interval</tt>.
    (Expressions of type <tt class="type">date</tt> will
    be cast to <tt class="type">timestamp</tt> and can therefore be used as
    well.)  <i class="replaceable"><tt>field</tt></i> is an identifier or
    string that selects what field to extract from the source value.
    The <tt class="function">extract</tt> function returns values of type
    <tt class="type">double precision</tt>.
    The following are valid field names:

    
    </p>
<div class="variablelist"><dl>
<dt><span class="term"><tt class="literal">century</tt></span></dt>
<dd>
<p>        The century
       </p>
<pre class="screen">SELECT EXTRACT(CENTURY FROM TIMESTAMP '2000-12-16 12:21:13');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">20</tt>
SELECT EXTRACT(CENTURY FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">21</tt></pre>
<p>        The first century starts at 0001-01-01 00:00:00 AD, although
        they did not know it at the time. This definition applies to all
        Gregorian calendar countries. There is no century number 0,
        you go from -1 to 1.

        If you disagree with this, please write your complaint to:
        Pope, Cathedral Saint-Peter of Roma, Vatican.
       </p>
<p>        <span class="productname">PostgreSQL</span> releases before 8.0 did not
        follow the conventional numbering of centuries, but just returned
        the year field divided by 100.
       </p>
</dd>
<dt><span class="term"><tt class="literal">day</tt></span></dt>
<dd>
<p>        The day (of the month) field (1 - 31)
       </p>
<pre class="screen">SELECT EXTRACT(DAY FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">16</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">decade</tt></span></dt>
<dd>
<p>        The year field divided by 10
       </p>
<pre class="screen">SELECT EXTRACT(DECADE FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">200</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">dow</tt></span></dt>
<dd>
<p>        The day of the week (0 - 6; Sunday is 0) (for
        <tt class="type">timestamp</tt> values only)
       </p>
<pre class="screen">SELECT EXTRACT(DOW FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">5</tt></pre>
<p>        Note that <tt class="function">extract</tt>'s day of the week numbering is 
        different from that of the <tt class="function">to_char</tt> function.
       </p>
</dd>
<dt><span class="term"><tt class="literal">doy</tt></span></dt>
<dd>
<p>        The day of the year (1 - 365/366) (for <tt class="type">timestamp</tt> values only)
       </p>
<pre class="screen">SELECT EXTRACT(DOY FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">47</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">epoch</tt></span></dt>
<dd>
<p>        For <tt class="type">date</tt> and <tt class="type">timestamp</tt> values, the
        number of seconds since 1970-01-01 00:00:00-00 (can be negative);
        for <tt class="type">interval</tt> values, the total number
        of seconds in the interval
       </p>
<pre class="screen">SELECT EXTRACT(EPOCH FROM TIMESTAMP WITH TIME ZONE '2001-02-16 20:38:40-08');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">982384720</tt>

SELECT EXTRACT(EPOCH FROM INTERVAL '5 days 3 hours');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">442800</tt></pre>
<p>        Here is how you can convert an epoch value back to a time
        stamp:
       </p>
<pre class="screen">SELECT TIMESTAMP WITH TIME ZONE 'epoch' + 982384720 * INTERVAL '1 second';</pre>
</dd>
<dt><span class="term"><tt class="literal">hour</tt></span></dt>
<dd>
<p>        The hour field (0 - 23)
       </p>
<pre class="screen">SELECT EXTRACT(HOUR FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">20</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">microseconds</tt></span></dt>
<dd>
<p>        The seconds field, including fractional parts, multiplied by 1
        000 000.  Note that this includes full seconds.
       </p>
<pre class="screen">SELECT EXTRACT(MICROSECONDS FROM TIME '17:12:28.5');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">28500000</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">millennium</tt></span></dt>
<dd>
<p>        The millennium
       </p>
<pre class="screen">SELECT EXTRACT(MILLENNIUM FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">3</tt></pre>
<p>        Years in the 1900s are in the second millennium.
        The third millennium starts January 1, 2001.
       </p>
<p>        <span class="productname">PostgreSQL</span> releases before 8.0 did not
        follow the conventional numbering of millennia, but just returned
        the year field divided by 1000.
       </p>
</dd>
<dt><span class="term"><tt class="literal">milliseconds</tt></span></dt>
<dd>
<p>        The seconds field, including fractional parts, multiplied by
        1000.  Note that this includes full seconds.
       </p>
<pre class="screen">SELECT EXTRACT(MILLISECONDS FROM TIME '17:12:28.5');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">28500</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">minute</tt></span></dt>
<dd>
<p>        The minutes field (0 - 59)
       </p>
<pre class="screen">SELECT EXTRACT(MINUTE FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">38</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">month</tt></span></dt>
<dd>
<p>        For <tt class="type">timestamp</tt> values, the number of the month
        within the year (1 - 12) ; for <tt class="type">interval</tt> values
        the number of months, modulo 12 (0 - 11)
       </p>
<pre class="screen">SELECT EXTRACT(MONTH FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2</tt>

SELECT EXTRACT(MONTH FROM INTERVAL '2 years 3 months');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">3</tt>

SELECT EXTRACT(MONTH FROM INTERVAL '2 years 13 months');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">1</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">quarter</tt></span></dt>
<dd>
<p>        The quarter of the year (1 - 4) that the day is in (for
        <tt class="type">timestamp</tt> values only)
       </p>
<pre class="screen">SELECT EXTRACT(QUARTER FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">1</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">second</tt></span></dt>
<dd>
<p>        The seconds field, including fractional parts (0 -
        59<sup>[<a name="id2556789" href="#ftn.id2556789">5</a>]</sup>)
       </p>
<pre class="screen">SELECT EXTRACT(SECOND FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">40</tt>

SELECT EXTRACT(SECOND FROM TIME '17:12:28.5');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">28.5</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">timezone</tt></span></dt>
<dd><p>        The time zone offset from UTC, measured in seconds.  Positive values
        correspond to time zones east of UTC, negative values to
        zones west of UTC.
       </p></dd>
<dt><span class="term"><tt class="literal">timezone_hour</tt></span></dt>
<dd><p>        The hour component of the time zone offset
       </p></dd>
<dt><span class="term"><tt class="literal">timezone_minute</tt></span></dt>
<dd><p>        The minute component of the time zone offset
       </p></dd>
<dt><span class="term"><tt class="literal">week</tt></span></dt>
<dd>
<p>        The number of the week of the year that the day is in.  By definition
        (<span class="acronym">ISO</span> 8601), the first week of a year
        contains January 4 of that year.  (The <span class="acronym">ISO</span>-8601
        week starts on Monday.)  In other words, the first Thursday of
        a year is in week 1 of that year. (for <tt class="type">timestamp</tt> values only)
       </p>
<pre class="screen">SELECT EXTRACT(WEEK FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">7</tt></pre>
</dd>
<dt><span class="term"><tt class="literal">year</tt></span></dt>
<dd>
<p>        The year field.  Keep in mind there is no <tt class="literal">0 AD</tt>, so subtracting 
        <tt class="literal">BC</tt> years from <tt class="literal">AD</tt> years should be done with care.
       </p>
<pre class="screen">SELECT EXTRACT(YEAR FROM TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001</tt></pre>
</dd>
</dl></div>
<p>

   </p>
<p>    The <tt class="function">extract</tt> function is primarily intended
    for computational processing.  For formatting date/time values for
    display, see <a href="functions-formatting.html" title="9.8. Data Type Formatting Functions">Section 9.8, &#8220;Data Type Formatting Functions&#8221;</a>.
   </p>
<p>    The <tt class="function">date_part</tt> function is modeled on the traditional
    <span class="productname">Ingres</span> equivalent to the
    <span class="acronym">SQL</span>-standard function <tt class="function">extract</tt>:
</p>
<pre class="synopsis">date_part('<i class="replaceable"><tt>field</tt></i>', <i class="replaceable"><tt>source</tt></i>)</pre>
<p>
    Note that here the <i class="replaceable"><tt>field</tt></i> parameter needs to
    be a string value, not a name.  The valid field names for
    <tt class="function">date_part</tt> are the same as for
    <tt class="function">extract</tt>.
   </p>
<pre class="screen">SELECT date_part('day', TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">16</tt>

SELECT date_part('hour', INTERVAL '4 hours 3 minutes');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">4</tt></pre>
</div>
<div class="sect2" lang="en">
<div class="titlepage">
<div><div><h3 class="title">
<a name="functions-datetime-trunc"></a>9.9.2. <tt class="function">date_trunc</tt></h3></div></div>
<div></div>
</div>
<p>    The function <tt class="function">date_trunc</tt> is conceptually
    similar to the <tt class="function">trunc</tt> function for numbers.
   </p>
<pre class="synopsis">date_trunc('<i class="replaceable"><tt>field</tt></i>', <i class="replaceable"><tt>source</tt></i>)</pre>
<p>
    <i class="replaceable"><tt>source</tt></i> is a value expression of type
    <tt class="type">timestamp</tt> or <tt class="type">interval</tt>.
    (Values of type <tt class="type">date</tt> and
    <tt class="type">time</tt> are cast automatically, to <tt class="type">timestamp</tt> or
    <tt class="type">interval</tt> respectively.)
    <i class="replaceable"><tt>field</tt></i> selects to which precision to
    truncate the input value.  The return value is of type
    <tt class="type">timestamp</tt> or <tt class="type">interval</tt>
    with all fields that are less significant than the
    selected one set to zero (or one, for day and month).
   </p>
<p>    Valid values for <i class="replaceable"><tt>field</tt></i> are:
    </p>
<table class="simplelist" border="0" summary="Simple list">
<tr><td><tt class="literal">microseconds</tt></td></tr>
<tr><td><tt class="literal">milliseconds</tt></td></tr>
<tr><td><tt class="literal">second</tt></td></tr>
<tr><td><tt class="literal">minute</tt></td></tr>
<tr><td><tt class="literal">hour</tt></td></tr>
<tr><td><tt class="literal">day</tt></td></tr>
<tr><td><tt class="literal">week</tt></td></tr>
<tr><td><tt class="literal">month</tt></td></tr>
<tr><td><tt class="literal">year</tt></td></tr>
<tr><td><tt class="literal">decade</tt></td></tr>
<tr><td><tt class="literal">century</tt></td></tr>
<tr><td><tt class="literal">millennium</tt></td></tr>
</table>
<p>
   </p>
<p>    Examples:
</p>
<pre class="screen">SELECT date_trunc('hour', TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-02-16 20:00:00</tt>

SELECT date_trunc('year', TIMESTAMP '2001-02-16 20:38:40');
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-01-01 00:00:00</tt></pre>
<p>
   </p>
</div>
<div class="sect2" lang="en">
<div class="titlepage">
<div><div><h3 class="title">
<a name="functions-datetime-zoneconvert"></a>9.9.3. <tt class="literal">AT TIME ZONE</tt></h3></div></div>
<div></div>
</div>
<a name="id2557226"></a><p>    The <tt class="literal">AT TIME ZONE</tt> construct allows conversions
    of time stamps to different time zones.  <a href="functions-datetime.html#functions-datetime-zoneconvert-table" title="Table 9.27. AT TIME ZONE Variants">Table 9.27, &#8220;AT TIME ZONE Variants&#8221;</a> shows its
    variants.
   </p>
<div class="table">
<a name="functions-datetime-zoneconvert-table"></a><p class="title"><b>Table 9.27. <tt class="literal">AT TIME ZONE</tt> Variants</b></p>
<table summary="AT TIME ZONE Variants" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Expression</th>
<th>Return Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><tt class="literal"><tt class="type">timestamp without time zone</tt> AT TIME ZONE <i class="replaceable"><tt>zone</tt></i></tt></td>
<td><tt class="type">timestamp with time zone</tt></td>
<td>Convert local time in given time zone to UTC</td>
</tr>
<tr>
<td><tt class="literal"><tt class="type">timestamp with time zone</tt> AT TIME ZONE <i class="replaceable"><tt>zone</tt></i></tt></td>
<td><tt class="type">timestamp without time zone</tt></td>
<td>Convert UTC to local time in given time zone</td>
</tr>
<tr>
<td><tt class="literal"><tt class="type">time with time zone</tt> AT TIME ZONE <i class="replaceable"><tt>zone</tt></i></tt></td>
<td><tt class="type">time with time zone</tt></td>
<td>Convert local time across time zones</td>
</tr>
</tbody>
</table>
</div>
<p>    In these expressions, the desired time zone <i class="replaceable"><tt>zone</tt></i> can be
    specified either as a text string (e.g., <tt class="literal">'PST'</tt>)
    or as an interval (e.g., <tt class="literal">INTERVAL '-08:00'</tt>).
    In the text case, the available zone names are those shown in
    <a href="datetime-keywords.html#datetime-timezone-input-table" title="Table B.4. Time Zone Abbreviations for Input">Table B.4, &#8220;Time Zone Abbreviations for Input&#8221;</a>.  (It would be useful
    to support the more general names shown in
    <a href="datetime-keywords.html#datetime-timezone-set-table" title="Table B.6. Time Zone Names for Setting timezone">Table B.6, &#8220;Time Zone Names for Setting timezone&#8221;</a>, but this is not yet
    implemented.)
   </p>
<p>    Examples (supposing that the local time zone is <tt class="literal">PST8PDT</tt>):
</p>
<pre class="screen">SELECT TIMESTAMP '2001-02-16 20:38:40' AT TIME ZONE 'MST';
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-02-16 19:38:40-08</tt>

SELECT TIMESTAMP WITH TIME ZONE '2001-02-16 20:38:40-05' AT TIME ZONE 'MST';
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-02-16 18:38:40</tt></pre>
<p>
    The first example takes a zone-less time stamp and interprets it as MST time
    (UTC-7) to produce a UTC time stamp, which is then rotated to PST (UTC-8)
    for display.  The second example takes a time stamp specified in EST
    (UTC-5) and converts it to local time in MST (UTC-7).
   </p>
<p>    The function <tt class="literal"><tt class="function">timezone</tt>(<i class="replaceable"><tt>zone</tt></i>,
    <i class="replaceable"><tt>timestamp</tt></i>)</tt> is equivalent to the SQL-conforming construct
    <tt class="literal"><i class="replaceable"><tt>timestamp</tt></i> AT TIME ZONE
    <i class="replaceable"><tt>zone</tt></i></tt>. 
   </p>
</div>
<div class="sect2" lang="en">
<div class="titlepage">
<div><div><h3 class="title">
<a name="functions-datetime-current"></a>9.9.4. Current Date/Time</h3></div></div>
<div></div>
</div>
<a name="id2557460"></a><a name="id2557468"></a><p>    The following functions are available to obtain the current date and/or
    time:
</p>
<pre class="synopsis">CURRENT_DATE
CURRENT_TIME
CURRENT_TIMESTAMP
CURRENT_TIME ( <i class="replaceable"><tt>precision</tt></i> )
CURRENT_TIMESTAMP ( <i class="replaceable"><tt>precision</tt></i> )
LOCALTIME
LOCALTIMESTAMP
LOCALTIME ( <i class="replaceable"><tt>precision</tt></i> )
LOCALTIMESTAMP ( <i class="replaceable"><tt>precision</tt></i> )</pre>
<p>
    </p>
<p>     <tt class="function">CURRENT_TIME</tt> and
     <tt class="function">CURRENT_TIMESTAMP</tt> deliver values with time zone;
     <tt class="function">LOCALTIME</tt> and
     <tt class="function">LOCALTIMESTAMP</tt> deliver values without time zone.
    </p>
<p>     <tt class="function">CURRENT_TIME</tt>,
     <tt class="function">CURRENT_TIMESTAMP</tt>,
     <tt class="function">LOCALTIME</tt>, and
     <tt class="function">LOCALTIMESTAMP</tt>
     can optionally be given
     a precision parameter, which causes the result to be rounded
     to that many fractional digits in the seconds field.  Without a precision parameter,
     the result is given to the full available precision.
    </p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>      Prior to <span class="productname">PostgreSQL</span> 7.2, the precision
      parameters were unimplemented, and the result was always given
      in integer seconds.
     </p>
</div>
<p>    Some examples:
</p>
<pre class="screen">SELECT CURRENT_TIME;
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">14:39:53.662522-05</tt>

SELECT CURRENT_DATE;
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-12-23</tt>

SELECT CURRENT_TIMESTAMP;
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-12-23 14:39:53.662522-05</tt>

SELECT CURRENT_TIMESTAMP(2);
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-12-23 14:39:53.66-05</tt>

SELECT LOCALTIMESTAMP;
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">2001-12-23 14:39:53.662522</tt></pre>
<p>
   </p>
<p>    The function <tt class="function">now()</tt> is the traditional
    <span class="productname">PostgreSQL</span> equivalent to
    <tt class="function">CURRENT_TIMESTAMP</tt>.
   </p>
<p>    There is also the function <tt class="function">timeofday()</tt>, which for historical
    reasons returns a <tt class="type">text</tt> string rather than a <tt class="type">timestamp</tt> value:
</p>
<pre class="screen">SELECT timeofday();
<i class="lineannotation"><span class="lineannotation">Result: </span></i><tt class="computeroutput">Sat Feb 17 19:07:32.000126 2001 EST</tt></pre>
<p>
   </p>
<p>    It is important to know that
    <tt class="function">CURRENT_TIMESTAMP</tt> and related functions return
    the start time of the current transaction; their values do not
    change during the transaction. This is considered a feature:
    the intent is to allow a single transaction to have a consistent
    notion of the &#8220;<span class="quote">current</span>&#8221; time, so that multiple
    modifications within the same transaction bear the same
    time stamp. <tt class="function">timeofday()</tt>
    returns the wall-clock time and does advance during transactions.
   </p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>     Other database systems may advance these values more
     frequently.
    </p>
</div>
<p>    All the date/time data types also accept the special literal value
    <tt class="literal">now</tt> to specify the current date and time.  Thus,
    the following three all return the same result:
</p>
<pre class="programlisting">SELECT CURRENT_TIMESTAMP;
SELECT now();
SELECT TIMESTAMP 'now';</pre>
<p>
   </p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Tip</h3>
<p>      You do not want to use the third form when specifying a <tt class="literal">DEFAULT</tt>
      clause while creating a table.  The system will convert <tt class="literal">now</tt>
      to a <tt class="type">timestamp</tt> as soon as the constant is parsed, so that when
      the default value is needed,
      the time of the table creation would be used!  The first two
      forms will not be evaluated until the default value is used,
      because they are function calls.  Thus they will give the desired
      behavior of defaulting to the time of row insertion.
     </p>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a name="ftn.id2556789" href="#id2556789">5</a>] </sup>60 if leap seconds are
        implemented by the operating system</p></div>
</div>
</div></body>
</html>
