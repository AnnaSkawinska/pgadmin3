<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>26.3. Platform-specific comparison files</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css">
<link rev="made" href="pgsql-docs@postgresql.org">
<meta name="generator" content="DocBook XSL Stylesheets V1.70.0">
<link rel="start" href="index.html" title="PostgreSQL 8.0.8 Documentation">
<link rel="up" href="regress.html" title="Chapter 26. Regression Tests">
<link rel="prev" href="regress-evaluation.html" title="26.2. Test Evaluation">
<link rel="next" href="client-interfaces.html" title="Part IV. Client Interfaces">
<link rel="copyright" href="ln-legalnotice.html" title="Legal Notice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="regress-platform"></a>26.3. Platform-specific comparison files</h2></div></div></div>
<p>    Since some of the tests inherently produce platform-specific
    results, we have provided a way to supply platform-specific result
    comparison files.  Frequently, the same variation applies to
    multiple platforms; rather than supplying a separate comparison
    file for every platform, there is a mapping file that defines
    which comparison file to use.  So, to eliminate bogus test
    &#8220;<span class="quote">failures</span>&#8221; for a particular platform, you must choose
    or make a variant result file, and then add a line to the mapping
    file, which is <code class="filename">src/test/regress/resultmap</code>.
   </p>
<p>    Each line in the mapping file is of the form
</p>
<pre class="synopsis">testname/platformpattern=comparisonfilename</pre>
<p>
    The test name is just the name of the particular regression test
    module.  The platform pattern is a pattern in the style of the Unix
    tool <code class="command">expr</code> (that is, a regular expression with an implicit
    <code class="literal">^</code> anchor
    at the start).  It is matched against the platform name as printed
    by <code class="command">config.guess</code> followed by
    <code class="literal">:gcc</code> or <code class="literal">:cc</code>, depending on
    whether you use the GNU compiler or the system's native compiler
    (on systems where there is a difference).  The comparison file
    name is the name of the substitute result comparison file.
   </p>
<p>    For example: some systems interpret very small floating-point values
    as zero, rather than reporting an underflow error.  This causes a
    few differences in the <code class="filename">float8</code> regression test.
    Therefore, we provide a variant comparison file,
    <code class="filename">float8-small-is-zero.out</code>, which includes
    the results to be expected on these systems.  To silence the bogus
    &#8220;<span class="quote">failure</span>&#8221; message on <span class="systemitem">OpenBSD</span>
    platforms, <code class="filename">resultmap</code> includes
</p>
<pre class="programlisting">float8/i.86-.*-openbsd=float8-small-is-zero</pre>
<p>
    which will trigger on any machine for which the output of
    <code class="command">config.guess</code> matches <code class="literal">i.86-.*-openbsd</code>.
    Other lines
    in <code class="filename">resultmap</code> select the variant comparison file for other
    platforms where it's appropriate.
   </p>
</div></body>
</html>
