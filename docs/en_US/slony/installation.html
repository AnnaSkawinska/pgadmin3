<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>4. Slony-I Installation</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css">
<link rev="made" href="pgsql-docs@postgresql.org">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<link rel="start" href="index.html" title="Slony-I HEAD_20051214 Documentation">
<link rel="up" href="slonyintro.html" title="Slony-I Introduction">
<link rel="prev" href="requirements.html" title="3. System Requirements">
<link rel="next" href="concepts.html" title="5. Slony-I Concepts">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="installation"></a>4. <span class="productname">Slony-I</span> Installation</h2></div></div></div>
<p>Note for <span class="trademark">Windows</span>&#8482; users: Unless you are planning on hacking the
<span class="productname">Slony-I</span> code, it is highly recommended that you download and install
a prebuilt binary distribution and jump straight to the configuration
section below.</p>
<p>You should have obtained the <span class="productname">Slony-I</span> source from the previous
step. Unpack it.</p>
<pre class="screen">gunzip slony.tar.gz;
tar xf slony.tar</pre>
<p> This will create a directory under the current directory with
the <span class="productname">Slony-I</span> sources.  Head into that that directory for the rest of
the installation procedure.</p>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id485933"></a>4.1. Short Version</h3></div></div></div>
<pre class="screen">PGMAIN=/usr/local/pgsql746-freebsd-2005-04-01 \
./configure \
    --prefix=$PGMAIN \
    --bindir=$PGMAIN/bin \
    --datadir=$PGMAIN/share \
    --libdir=$PGMAIN/lib \
    --with-pgconfigdir=$PGMAIN/bin \
    --with-pgbindir=$PGMAIN/bin \
    --with-pgincludedir=$PGMAIN/include \
    --with-pglibdir=$PGMAIN/lib \
    --with-pgsharedir=$PGMAIN/share
gmake all; gmake install</pre>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id485950"></a>4.2. Configuration</h3></div></div></div>
<p>The first step of the installation procedure is to configure the
source tree for your system.  This is done by running the
<span class="application">configure</span> script.  In early versions,
<span class="application">configure</span> needed to know where your
<span class="productname">PostgreSQL</span> source tree is, which was done with the
<code class="option">--with-pgsourcetree=</code> option.  As of version 1.1, this
is no longer necessary, as <span class="productname">Slony-I</span> has included within its own code
base certain parts needed for platform portability.  It now only needs
to make reference to parts of <span class="productname">PostgreSQL</span> that are actually part of the
installation.  Therefore, <span class="productname">Slony-I</span> is configured by pointing it to the
various library, binary, and include directories.  For a full list of
these options, use the command <code class="command">./configure --help</code></p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id486015"></a>4.3. Example</h3></div></div></div>
<p> After determining that the <span class="productname">PostgreSQL</span> instance to be used is
installed in
<code class="filename">/opt/dbs/pgsql746-aix-2005-04-01</code>:</p>
<pre class="screen">PGMAIN=/opt/dbs/pgsql746-aix-2005-04-01 \
./configure \
    --prefix=$PGMAIN \
    --bindir=$PGMAIN/bin \
    --datadir=$PGMAIN/share \
    --libdir=$PGMAIN/lib \
    --with-pgconfigdir=$PGMAIN/bin \
    --with-pgbindir=$PGMAIN/bin \
    --with-pgincludedir=$PGMAIN/include \
    --with-pglibdir=$PGMAIN/lib \
    --with-pgsharedir=$PGMAIN/share</pre>
<p>The <span class="application">configure</span> script will run a
number of tests to guess values for various dependent variables and
try to detect some quirks of your system.  <span class="productname">Slony-I</span> is known to need a
modified version of <span class="application">libpq</span> on specific
platforms such as Solaris2.X on SPARC.  The patch for libpq version
7.4.2 can be found at <a name="threadpatch" href="http://developer.postgresql.org/~wieck/slony1/download/threadsafe-libpq-742.diff.gz" target="_top">http://developer.postgresql.org/~wieck/slony1/download/threadsafe-libpq-742.diff.gz</a> Similar patches may need to be constructed for other
versions; see the FAQ entry on <a href="faq.html#threadsafety"> thread
safety </a>. </p>
<p> For a full listing of configuration options, run the command
<code class="command">./configure --help</code>.</p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id486108"></a>4.4. Build</h3></div></div></div>
<p>To start the build process, type

</p>
<pre class="screen">gmake all</pre>
<p> Be sure to use GNU make; on BSD systems, it is called
<span class="application">gmake</span>; on Linux, GNU make is typically the
&#8220;<span class="quote">native</span>&#8221; <span class="application">make</span>, so the name of
the command you type in may be either <code class="command">make</code> or
<code class="command">gmake</code>.  On other platforms, you may need additional
packages or even install GNU make from scratch.  The build may take
anywhere from a few seconds to 2 minutes depending on how fast your
hardware is at compiling things.  The last line displayed should
be</p>
<p> <code class="command"> All of Slony-I is successfully made.  Ready to
install.  </code></p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id486167"></a>4.5.  Installing <span class="productname">Slony-I</span></h3></div></div></div>
<p> To install <span class="productname">Slony-I</span>, enter

<code class="command">gmake install</code></p>
<p>This will install files into the postgresql install directory as
specified by the <code class="command">configure</code>
<code class="option">--prefix</code> option used in the <span class="productname">PostgreSQL</span> installation.
Make sure you have appropriate permissions to write into that area.
Commonly you need to do this either as root or as the postgres user.</p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id486215"></a>4.6.  Installing <span class="productname">Slony-I</span> from RPMs</h3></div></div></div>
<p> Even though <span class="productname">Slony-I</span> can be compiled and run on most Linux 
distributions, it is also possible to install <span class="productname">Slony-I</span> using binary 
packages. Slony Global Development Team provides official RPMs and SRPMs 
for many versions or Red Hat ana Fedora Core.</p>
<p>The RPMs are available at 
http://developer.PostgreSQL.org/~devrim/slony . Please read <code class="command"> 
CURRENT_MAINTAINER</code> file for the details of the RPMs. 
Please note that the RPMs will look for RPM installation of 
<span class="productname">PostgreSQL</span>, so if you install <span class="productname">PostgreSQL</span> from source, you should 
manually ignore the RPM dependencies related to <span class="productname">PostgreSQL</span>.</p>
<p>Installing <span class="productname">Slony-I</span> using these RPMs is as easy as 
installing any RPM.</p>
<pre class="screen">rpm -ivh postgresql-slony1-engine-....rpm</pre>
<p>If you want to upgrade the previous version, just use 
<code class="command">rpm -Uvh</code> to upgrade it. But please remember to follow 
the usual upgrade procedure, too.</p>
<p>The RPM installs the files into their usual places. The 
configuration files are installed under /etc, the binary files are 
installed to /usr/bin, libs are installed to /usr/lib/pgsql, and finally 
the docs are installed under 
/usr/share/doc/postgresql-slony1-engine.</p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id486313"></a>4.7.  Installing the <span class="productname">Slony-I</span> service on <span class="trademark">Windows</span>&#8482;</h3></div></div></div>
<p> On <span class="trademark">Windows</span>&#8482; systems, instead of running one slon daemon per
node, a single slon service is installed which can then be controlled
through the <code class="command">Services</code> control panel applet, or from
a command prompt using the <code class="command">net</code> command.</p>
<pre class="screen">C:\Program Files\PostgreSQL\8.0\bin&gt; slon -regservice my_slon
Service registered.
Before you can run Slony, you must also register an engine!

WARNING! Service is registered to run as Local System. You are
encouraged to change this to a low privilege account to increase
system security. </pre>
<p> Once the service is installed, individual nodes can be setup
by registering slon configuration files with the service.</p>
<pre class="screen">C:\Program Files\PostgreSQL\8.0\bin&gt; slon -addengine c:\node1.conf
Engine added.</pre>
<p>Other, self explanatory commands include <code class="command">slon -unregservice 
&lt;service name&gt;</code>, <code class="command">slon -listengines 
&lt;service name&gt;</code> and <code class="command">slon -delengine 
&lt;service name&gt; &lt;config file&gt;</code>.</p>
</div>
</div></body>
</html>
